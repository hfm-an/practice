{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap b43d21f0474b03f36356","webpack:///./src/index.js","webpack:///./src/observe.js","webpack:///./src/dep.js","webpack:///./src/utils.js","webpack:///./src/domResolve.js","webpack:///./src/resolveUtil.js","webpack:///./src/resolveReducers.js","webpack:///./src/watcher.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;sBC7BwB,GAAG;;;;oCAHP,CAAW;;;;uCACR,CAAc;;;;AAEtB,UAAS,GAAG,CAAE,GAAG,EAAE;AAC9B,SAAI,CAAC,IAAI,GAAG,GAAG;AACf,SAAI,CAAC,KAAK,GAAG,GAAG,CAAC,IAAI;;;AAGrB,0BAAQ,IAAI,CAAC,KAAK,CAAC;;;AAGnB,iCAAe,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC;EACrC;;;;;;;;;;;;;;;;;;;;gCCZe,CAAO;;;;kCACL,CAAS;;;;AAE3B,UAAS,OAAO,CAAE,IAAI,EAAE;AACpB,SAAI,OAAO,CAAC,IAAI,CAAC;EACpB;;;;;;;AAOD,UAAS,OAAO,CAAE,IAAI,EAAE;AACpB,SAAI,CAAC,IAAI,GAAG,IAAI;AAChB,SAAI,CAAC,IAAI,EAAE;EACd;;AAED,KAAM,KAAK,GAAG,OAAO,CAAC,SAAS;;;;;AAK/B,MAAK,CAAC,IAAI,GAAG,YAAY;;;AACrB,SAAI,KAAK,GAAG,IAAI,CAAC,IAAI;;AAErB,WAAM,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CACjB,GAAG,CAAC,UAAC,GAAG,EAAK;AACV,eAAK,cAAc,CAAC,GAAG,EAAE,KAAK,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC;MAC9C,CAAC;EACT;;AAED,MAAK,CAAC,cAAc,GAAG,UAAU,GAAG,EAAE,IAAI,EAAE,GAAG,EAAE;AAC7C,SAAI,KAAK,GAAG,GAAG;AACf,SAAM,GAAG,GAAG,sBAAS;;AAErB,SAAI,mBAAM,QAAQ,CAAC,GAAG,CAAC,EAAE;AACrB,gBAAO,CAAC,GAAG,CAAC;MACf;AACD,WAAM,CAAC,cAAc,CACjB,IAAI,EACJ,GAAG,EACH;;;;;;AAMI,YAAG,EAAC,eAAG;AACH,iBAAI,iBAAI,MAAM,EAAE;AACZ,oBAAG,CAAC,MAAM,EAAE;cACf;;AAED,oBAAO,KAAK;UACf;;;;;;AAMD,YAAG,EAAC,aAAC,QAAQ,EAAE;AACX,kBAAK,GAAG,QAAQ;;AAEhB,gBAAG,CAAC,MAAM,EAAE;UACf;MACJ,CACJ;EACJ;;sBAGc,OAAO;;;;;;;;;;;;;;;;ACrEtB,KAAI,EAAE,GAAG,CAAC;;AAEV,UAAS,GAAG,GAAI;;AAEZ,SAAI,CAAC,EAAE,GAAG,EAAE,EAAG;;AAEf,SAAI,CAAC,IAAI,GAAG,EAAE;EACjB;;AAED,KAAM,KAAK,GAAG,GAAG,CAAC,SAAS;;AAE3B,MAAK,CAAC,MAAM,GAAG,YAAY;AACvB,QAAG,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC;EAC1B;;AAED,MAAK,CAAC,MAAM,GAAG,UAAU,OAAO,EAAE;AAC9B,SAAI,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC;EAC1B;;AAED,MAAK,CAAC,MAAM,GAAG,YAAY;AACvB,SAAI,CAAC,IAAI,CAAC,GAAG,CAAC,aAAG,EAAI;AACjB,YAAG,CAAC,MAAM,EAAE;MACf,CAAC;EACL;;sBAEc,GAAG;;;;;;;;;;;;;;;;ACzBlB,KAAM,KAAK,GAAG,EAAE;;;;;AAMhB,KAAM,UAAU,GAAG,CAAC,QAAQ,EAAE,QAAQ,EAAE,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,MAAM,EAAE,WAAW,CAAC;;AAE1F,WAAU,CAAC,GAAG,CAAC,cAAI,EAAI;AACnB,UAAK,QAAM,IAAI,CAAG,GAAG,UAAU,GAAG,EAAE;AAChC,gBAAO,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,kBAAgB,IAAI,MAAG;MACpE;EACJ,CAAC;;;;;;;AAOF,MAAK,CAAC,aAAa,GAAG,UAAU,IAAI,EAAE;AAClC,YAAO,IAAI,CAAC,QAAQ,KAAK,CAAC;EAC7B;;AAED,MAAK,CAAC,UAAU,GAAG,UAAU,IAAI,EAAE;AAC/B,YAAO,IAAI,CAAC,QAAQ,KAAK,CAAC;EAC7B;;sBAEc,KAAK;;;;;;;;;;;;;;;;;;;kCC3BF,CAAS;;;;wCACH,CAAe;;;;AAEvC,UAAS,UAAU,CAAE,EAAE,EAAE,EAAE,EAAE;AACzB,SAAI,CAAC,EAAE,GAAG,EAAE;AACZ,SAAI,CAAC,IAAI,GAAG,EAAE,CAAC,KAAK;;;AAGpB,SAAI,CAAC,mBAAM,aAAa,CAAC,EAAE,CAAC,EAAE;AAC1B,WAAE,GAAG,QAAQ,CAAC,aAAa,CAAC,EAAE,CAAC;MAClC;AACD,SAAI,CAAC,GAAG,GAAG,EAAE;;;AAGb,SAAI,QAAQ,GAAG,QAAQ,CAAC,sBAAsB,EAAE;AAChD,aAAQ,GAAG,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC;AACnC,SAAI,CAAC,SAAS,GAAG,QAAQ;;;AAGzB,SAAI,CAAC,WAAW,EAAE;;AAElB,aAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC;;AAEnC,aAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,SAAS,CAAC;EAC5C;;AAED,KAAM,KAAK,GAAG,UAAU,CAAC,SAAS;;AAElC,MAAK,CAAC,WAAW,GAAG,YAAY;;;AAC5B,SAAI,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU;AACtC,SAAM,WAAW,GAAG,cAAc,CACjC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CACjB,GAAG,CAAC,cAAI,EAAI;AACT,aAAI,mBAAM,UAAU,CAAC,IAAI,CAAC,IAAI,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE;AAC9D,mBAAK,eAAe,CAChB,IAAI,EACJ,IAAI,CAAC,WAAW,CACX,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CACjB,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CACjB,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAC1B;UACJ;MACJ,CAAC;EACT;;AAED,MAAK,CAAC,eAAe,GAAG,UAAU,IAAI,EAAE,YAAY,EAAE;AAClD,8BAAY,IAAI,CAAC,IAAI,EAAE,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC;EAChD;;sBAEc,UAAU;;;;;;;;;;;;;;;;;;;;4CChDG,CAAmB;;;;oCAC3B,CAAW;;;;AAE/B,KAAM,WAAW,GAAG;AAChB,SAAI,EAAC,cAAC,IAAI,EAAE,YAAY,EAAE,EAAE,EAAE;AAC1B,aAAI,CAAC,IAAI,CAAC,IAAI,EAAE,YAAY,EAAE,MAAM,EAAE,EAAE,CAAC;MAC5C;AACD,SAAI,EAAC,cAAC,IAAI,EAAE,YAAY,EAAE,IAAI,EAAE,EAAE,EAAE;AAChC,aAAM,eAAe,GAAG,6BAAmB,IAAI,aAAU;AACzD,wBAAe,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;AACtD,kCAAY,EAAE,EAAE,YAAY,EAAE,UAAU,QAAQ,EAAE;AAC9C,4BAAe,CAAC,IAAI,EAAE,QAAQ,CAAC;UAClC,CAAC;MACL;;;;AAID,aAAQ,EAAC,kBAAC,YAAY,EAAE,EAAE,EAAE;AACxB,gBAAO,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC;MAChC;EACJ;;sBAEc,WAAW;;;;;;;;;;;;;;;;sBCvBX;AACX,gBAAW,EAAC,qBAAC,IAAI,EAAE,KAAK,EAAE;AACtB,aAAI,CAAC,WAAW,GAAG,KAAK;MAC3B;EACJ;;;;;;;;;;;;;;;;;;;gCCJe,CAAO;;;;AAEvB,UAAS,OAAO,CAAE,EAAE,EAAE,YAAY,EAAE,EAAE,EAAE;AACpC,SAAI,CAAC,EAAE,GAAG,EAAE;AACZ,SAAI,CAAC,EAAE,GAAG,EAAE;AACZ,SAAI,CAAC,MAAM,GAAG,EAAE;;AAEhB,SAAI,CAAC,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC;AAC9C,SAAI,CAAC,KAAK,GAAG,IAAI,CAAC,QAAQ,EAAE;EAC/B;;AAED,KAAM,KAAK,GAAG,OAAO,CAAC,SAAS;;;;;;AAM/B,MAAK,CAAC,QAAQ,GAAG,YAAY;AACzB,sBAAI,MAAM,GAAG,IAAI;AACjB,SAAI,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE;AACzB,sBAAI,MAAM,GAAG,IAAI;AACjB,YAAO,KAAK;EACf;;;;;;;AAOD,MAAK,CAAC,aAAa,GAAG,UAAU,YAAY,EAAE;AAC1C,SAAI,KAAK,GAAG,IAAI;AAChB,YAAO,YAAY;AACf,gBAAO,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,YAAY,CAAC;MACtC;EACJ;;AAED,MAAK,CAAC,MAAM,GAAG,UAAU,GAAG,EAAE;AAC1B,SAAI,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE;AACtB,aAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI;AAC1B,YAAG,CAAC,MAAM,CAAC,IAAI,CAAC;MACnB;EACJ;;AAED,MAAK,CAAC,MAAM,GAAG,YAAY;AACvB,SAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE;AAC1B,SAAI,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC;EACtB;;sBAEc,OAAO","file":"hfm.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Hfm\"] = factory();\n\telse\n\t\troot[\"Hfm\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b43d21f0474b03f36356","/**\n* @Author : Amnhh\n* @Date : 2018/10/17\n* @Email : amnhhlod@163.com\n* @Description :\n*/\nimport observe from './observe'\nimport DomResolve from './domResolve'\n\nexport default function Hfm (opt) {\n    this.$opt = opt\n    this.$data = opt.data\n    \n    // 观察每个属性值\n    observe(this.$data)\n    \n    // 解析 dom\n    new DomResolve(this.$opt.el, this)\n}\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\n * @Author : Amnhh\n * @Date : 2018/10/17\n * @Email : amnhhlod@163.com\n * @Description :\n */\nimport Dep from './dep'\nimport Utils from './utils'\n\nfunction observe (data) {\n    new Observe(data)\n}\n\n/**\n * 观察者构造函数\n * @param data\n * @constructor\n */\nfunction Observe (data) {\n    this.data = data\n    this.init()\n}\n\nconst proto = Observe.prototype\n\n/**\n * 初始化这些数据，设置属性的 getter 和 setter\n */\nproto.init = function () {\n    let _data = this.data\n    // 每个属性都为他们设置 getter 和 setter\n    Object.keys(this.data)\n        .map((key) => {\n            this.defineReactive(key, _data, _data[key])\n        })\n}\n\nproto.defineReactive = function (key, data, val) {\n    let value = val\n    const dep = new Dep()\n    // 如果一级属性是一个对象的话，则将他的属性也设置 getter 和 setter\n    if (Utils.isObject(val)) {\n        observe(val)\n    }\n    Object.defineProperty(\n        data,\n        key,\n        {\n            /**\n             * 当一个属性在页面里被 get 的时候，说明页面里的某个 dom 元素或者指令，依赖这个属性\n             * 所以依赖的收集是在 get 中进行\n             * @returns {*}\n             */\n            get () {\n                if (Dep.target) {\n                    dep.depend()\n                }\n                // 订阅者的收集\n                return value\n            },\n            /**\n             * 观察-订阅的这种模式中，\n             * 如果属性改变，就需要通知每一个订阅者，触发订阅者相关的方法\n             * @param newValue\n             */\n            set (newValue) {\n                value = newValue\n                // 属性被重新赋值的时候，通知订阅者执行相应的方法\n                dep.notify()\n            }\n        }\n    )\n}\n\n\nexport default observe\n\n\n// WEBPACK FOOTER //\n// ./src/observe.js","/**\n * @Author : Amnhh\n * @Date : 2018/10/17\n * @Email : amnhhlod@163.com\n * @Description :\n */\nlet id = 1\n\nfunction Dep () {\n    // 每个 Dep 的唯一标识\n    this.id = id ++\n    // 依赖列表\n    this.subs = []\n}\n\nconst proto = Dep.prototype\n\nproto.depend = function () {\n    Dep.target.addDep(this)\n}\n\nproto.addSub = function (watcher) {\n    this.subs.push(watcher)\n}\n\nproto.notify = function () {\n    this.subs.map(sub => {\n        sub.update()\n    })\n}\n\nexport default Dep\n\n\n// WEBPACK FOOTER //\n// ./src/dep.js","/**\n * @Author : Amnhh\n * @Date : 2018/10/17\n * @Email : amnhhlod@163.com\n * @Description :\n */\nconst utils = {}\n\n\n/**\n * 状态检查函数\n */\nconst TYPE_NAMES = ['String', 'Number', 'Object', 'Array', 'Boolean', 'Null', 'Undefined']\n\nTYPE_NAMES.map(type => {\n    utils[`is${type}`] = function (val) {\n        return Object.prototype.toString.call(val) === `[object ${type}]`\n    }\n})\n\n/**\n * 检测是否是 dom element\n * @param node\n * @returns {boolean}\n */\nutils.isElementNode = function (node) {\n    return node.nodeType === 1\n}\n\nutils.isTextNode = function (node) {\n    return node.nodeType === 3\n}\n\nexport default utils\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","/**\n * 解析 dom\n * @param el dom 的选择器\n * @param vm 我们解析了 dom 需要和 vm.$data 挂钩，所以 vm 也需要传入\n * @constructor\n */\nimport Utils from './utils'\nimport resolveUtil from './resolveUtil'\n\nfunction DomResolve (el, vm) {\n    this.vm = vm\n    this.data = vm.$data\n\n    // 确保 el 为 dom 元素\n    if (!Utils.isElementNode(el)) {\n        el = document.querySelector(el)\n    }\n    this.$el = el\n\n    // 先拷贝出来一份 $el, 在内存里处理和完成绑定之后，再覆盖回去\n    let fragment = document.createDocumentFragment()\n    fragment = this.$el.cloneNode(true)\n    this.$fragment = fragment\n\n    // 将所有绑定全都在 fragment 上执行一遍\n    this.initResolve()\n    // 然后移除 #app\n    document.body.removeChild(this.$el)\n    // 再往 body 里把 fragment 的 #app 填充进去\n    document.body.appendChild(this.$fragment)\n}\n\nconst proto = DomResolve.prototype\n\nproto.initResolve = function () {\n    let childs = this.$fragment.childNodes\n    const BRACKET_REG = /\\{\\{(.*)\\}\\}/\n    ;[].slice.call(childs)\n        .map(node => {\n            if (Utils.isTextNode(node) && BRACKET_REG.test(node.textContent)) {\n                this.resolveTextNode(\n                    node,\n                    node.textContent\n                        .replace('{{', '')\n                        .replace('}}', '')\n                        .replace(/\\s/g, '')\n                )\n            }\n        })\n}\n\nproto.resolveTextNode = function (node, propertyName) {\n    resolveUtil.text(node, propertyName, this.vm)\n}\n\nexport default DomResolve\n\n\n// WEBPACK FOOTER //\n// ./src/domResolve.js","/**\n * @Author : Amnhh\n * @Date : 2018/10/17\n * @Email : amnhhlod@163.com\n * @Description :\n */\n\nimport resolveReducers from './resolveReducers'\nimport Watcher from './watcher'\n\nconst resolveUtil = {\n    text (node, propertyName, vm) {\n        this.bind(node, propertyName, 'text', vm)\n    },\n    bind (node, propertyName, type, vm) {\n        const reducerFunction = resolveReducers[`${type}Reducer`]\n        reducerFunction(node, this.getValue(propertyName, vm))\n        new Watcher(vm, propertyName, function (newValue) {\n            reducerFunction(node, newValue)\n        })\n    },\n    /**\n     * 这一步没有执行依赖的收集，只是单纯的替换文本\n     */\n    getValue (propertyName, vm) {\n        return vm.$data[propertyName]\n    }\n}\n\nexport default resolveUtil\n\n\n// WEBPACK FOOTER //\n// ./src/resolveUtil.js","/**\n * @Author : Amnhh\n * @Date : 2018/10/17\n * @Email : amnhhlod@163.com\n * @Description :\n */\nexport default {\n    textReducer (node, value) {\n        node.textContent = value\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/resolveReducers.js","/**\n * @Author : Amnhh\n * @Date : 2018/10/17\n * @Email : amnhhlod@163.com\n * @Description :\n */\nimport Dep from './dep'\n\nfunction Watcher (vm, propertyName, cb) {\n    this.vm = vm\n    this.cb = cb\n    this.depMap = {}\n\n    this.getter = this.getterFactory(propertyName)\n    this.value = this.getValue()\n}\n\nconst proto = Watcher.prototype\n\n/**\n * 用于获取绑定依赖\n * @returns {*}\n */\nproto.getValue = function () {\n    Dep.target = this\n    let value = this.getter()\n    Dep.target = null\n    return value\n}\n\n/**\n * 生产一个 getter 函数，用于获取属性的值\n * @param propertyName\n * @returns {Function}\n */\nproto.getterFactory = function (propertyName) {\n    let _self = this\n    return function () {\n        return _self.vm.$data[propertyName]\n    }\n}\n\nproto.addDep = function (dep) {\n    if (!this.depMap[dep.id]) {\n        this.depMap[dep.id] = true\n        dep.addSub(this)\n    }\n}\n\nproto.update = function () {\n    this.value = this.getter()\n    this.cb(this.value)\n}\n\nexport default Watcher\n\n\n// WEBPACK FOOTER //\n// ./src/watcher.js"],"sourceRoot":""}